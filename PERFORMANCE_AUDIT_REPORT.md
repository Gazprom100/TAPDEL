# üîç –î–ï–¢–ê–õ–ò–ó–ò–†–û–í–ê–ù–ù–´–ô –ê–£–î–ò–¢ –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò TAPDEL

## üéØ –¶–ï–õ–¨ –ê–£–î–ò–¢–ê
–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ **2000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ **–º–µ–¥–ª–µ–Ω–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É —Ä–µ–π—Ç–∏–Ω–≥–∞** –ø—Ä–∏ —Ç–µ–∫—É—â–∏—Ö 5 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö.

## ‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´

### **1. –ü–†–û–ë–õ–ï–ú–ê –° API –†–û–£–¢–ê–ú–ò**
- **–°—Ç–∞—Ç—É—Å**: ‚ùå –ö–†–ò–¢–ò–ß–ù–û
- **–û–ø–∏—Å–∞–Ω–∏–µ**: API —Ä–æ—É—Ç—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç –∏–∑-–∑–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ —Å–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏
- **–í–ª–∏—è–Ω–∏–µ**: –ü–æ–ª–Ω–∞—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞
- **–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ —Ä–æ—É—Ç–æ–≤ –≤ server.js

### **2. –ü–£–°–¢–ê–Ø –ë–ê–ó–ê –î–ê–ù–ù–´–•**
- **–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ö–æ–ª–ª–µ–∫—Ü–∏–∏ `users` –∏ `leaderboard` –ø—É—Å—Ç—ã
- **–í–ª–∏—è–Ω–∏–µ**: –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **–†–µ—à–µ–Ω–∏–µ**: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### **3. –ú–ï–î–õ–ï–ù–ù–ê–Ø –ó–ê–ì–†–£–ó–ö–ê –†–ï–ô–¢–ò–ù–ì–ê**
- **–°—Ç–∞—Ç—É—Å**: üîç –¢–†–ï–ë–£–ï–¢ –ê–ù–ê–õ–ò–ó–ê
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü—Ä–∏ 5 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö —Ä–µ–π—Ç–∏–Ω–≥ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –º–µ–¥–ª–µ–Ω–Ω–æ
- **–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã**:
  - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –≤ MongoDB
  - –ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
  - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
  - –ü—Ä–æ–±–ª–µ–º—ã —Å Redis

## üìä –ê–ù–ê–õ–ò–ó –ö–û–î–ê

### **Frontend (React/TypeScript)**

#### **–ü—Ä–æ–±–ª–µ–º—ã –≤ `src/store/gameStore.ts`:**
```typescript
// –ü–†–û–ë–õ–ï–ú–ê: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞
refreshLeaderboard: async () => {
  try {
    const state = get();
    const dbLeaderboard = await apiService.getLeaderboard(); // –ë–µ–∑ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
    // ... –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
  } catch (error) {
    console.error('‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞:', error);
  }
}
```

#### **–ü—Ä–æ–±–ª–µ–º—ã –≤ `src/components/Profile.tsx`:**
```typescript
// –ü–†–û–ë–õ–ï–ú–ê: –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
interval = setInterval(updateLeaderboard, 30000); // –°–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ
```

### **Backend (Node.js/Express)**

#### **–ü—Ä–æ–±–ª–µ–º—ã –≤ `backend/routes/api.js`:**
```javascript
// –ü–†–û–ë–õ–ï–ú–ê: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
router.get('/leaderboard', async (req, res) => {
  const leaderboard = await database.collection('leaderboard')
    .find()
    .sort({ tokens: -1 })
    .skip(skip)
    .limit(limit)
    .toArray(); // –ù–µ—Ç –∏–Ω–¥–µ–∫—Å–æ–≤, –Ω–µ—Ç –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
});
```

#### **–ü—Ä–æ–±–ª–µ–º—ã –≤ `backend/services/cacheService.js`:**
```javascript
// –ü–†–û–ë–õ–ï–ú–ê: Redis –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
async initialize() {
  try {
    await this.redis.connect(); // –ü–∞–¥–∞–µ—Ç —Å –æ—à–∏–±–∫–∞–º–∏ TLS
  } catch (error) {
    console.warn('‚ö†Ô∏è Cache Service –±–µ–∑ Redis:', error.message);
  }
}
```

## üöÄ –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò –î–õ–Ø 2000 –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô

### **1. –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï API –†–û–£–¢–û–í**

#### **–í `backend/server.js`:**
```javascript
// –ü–†–ê–í–ò–õ–¨–ù–´–ô –ü–û–†–Ø–î–û–ö –†–û–£–¢–û–í
app.use('/api/telegram', telegramRoutes);
app.use('/api', apiRoutes);
app.use('/api/decimal', decimalRoutes);

// –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –¢–û–õ–¨–ö–û –¥–ª—è –Ω–µ-API —Ä–æ—É—Ç–æ–≤
app.use((req, res, next) => {
  if (req.path.startsWith('/api/')) {
    return next();
  }
  express.static(path.join(__dirname, '../dist'))(req, res, next);
});
```

### **2. –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø MONGODB**

#### **–ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞:**
```javascript
// –í backend/config/database.js
await collection.createIndex({ tokens: -1 }); // –î–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
await collection.createIndex({ userId: 1 }); // –î–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
await collection.createIndex({ updatedAt: -1 }); // –î–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
```

#### **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤:**
```javascript
// –ü—Ä–æ–µ–∫—Ü–∏—è —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã—Ö –ø–æ–ª–µ–π
const leaderboard = await database.collection('leaderboard')
  .find({}, { 
    projection: { 
      username: 1, 
      tokens: 1, 
      rank: 1,
      _id: 0 
    } 
  })
  .sort({ tokens: -1 })
  .limit(limit)
  .toArray();
```

### **3. –ö–ï–®–ò–†–û–í–ê–ù–ò–ï**

#### **Redis –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```javascript
// –ö–µ—à –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞ –Ω–∞ 5 –º–∏–Ω—É—Ç
const cacheKey = `leaderboard:page:${page}:limit:${limit}`;
const cached = await cacheService.get(cacheKey);
if (cached) return cached;

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∫–µ—à
await cacheService.set(cacheKey, leaderboard, 300);
```

#### **–õ–æ–∫–∞–ª—å–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```javascript
// –í frontend
const leaderboardCache = new Map();
const CACHE_TTL = 30000; // 30 —Å–µ–∫—É–Ω–¥

const getCachedLeaderboard = () => {
  const cached = leaderboardCache.get('leaderboard');
  if (cached && Date.now() - cached.timestamp < CACHE_TTL) {
    return cached.data;
  }
  return null;
};
```

### **4. –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø FRONTEND**

#### **–£–º–µ–Ω—å—à–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤:**
```typescript
// –í–º–µ—Å—Ç–æ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
interval = setInterval(updateLeaderboard, 60000); // –ö–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É

// –£—Å–ª–æ–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
if (activeTab === 'leaderboard' && !isLeaderboardLoading) {
  updateLeaderboard();
}
```

#### **Batch –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
```typescript
// –û–±–Ω–æ–≤–ª—è–µ–º –ª–∏–¥–µ—Ä–±–æ—Ä–¥ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–µ–π—Ç–∏–Ω–≥–∞
const lastUpdate = useRef<number>(0);
const updateThreshold = 5000; // 5 —Å–µ–∫—É–Ω–¥

if (Date.now() - lastUpdate.current > updateThreshold) {
  await refreshLeaderboard();
  lastUpdate.current = Date.now();
}
```

### **5. –ü–ê–ì–ò–ù–ê–¶–ò–Ø –ò –õ–ê–ó–ò –õ–û–ê–î–ò–ù–ì**

#### **Backend –ø–∞–≥–∏–Ω–∞—Ü–∏—è:**
```javascript
router.get('/leaderboard', async (req, res) => {
  const page = parseInt(req.query.page) || 1;
  const limit = parseInt(req.query.limit) || 50;
  const skip = (page - 1) * limit;
  
  const leaderboard = await database.collection('leaderboard')
    .find()
    .sort({ tokens: -1 })
    .skip(skip)
    .limit(limit)
    .toArray();
});
```

#### **Frontend –ª–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞:**
```typescript
const [leaderboard, setLeaderboard] = useState<LeaderboardEntry[]>([]);
const [hasMore, setHasMore] = useState(true);
const [page, setPage] = useState(1);

const loadMore = async () => {
  const newEntries = await apiService.getLeaderboard(page + 1, 50);
  setLeaderboard(prev => [...prev, ...newEntries]);
  setPage(prev => prev + 1);
  setHasMore(newEntries.length === 50);
};
```

## üìà –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨

### **–¢–µ–∫—É—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏ (5 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π):**
- **–í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞**: 2-5 —Å–µ–∫—É–Ω–¥ ‚ùå
- **–ß–∞—Å—Ç–æ—Ç–∞ –∑–∞–ø—Ä–æ—Å–æ–≤**: –ö–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ ‚ùå
- **–†–∞–∑–º–µ—Ä –æ—Ç–≤–µ—Ç–∞**: ~1KB ‚úÖ
- **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ‚ùå

### **–¶–µ–ª–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (2000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π):**
- **–í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞**: <500ms ‚úÖ
- **–ß–∞—Å—Ç–æ—Ç–∞ –∑–∞–ø—Ä–æ—Å–æ–≤**: –ö–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã ‚úÖ
- **–†–∞–∑–º–µ—Ä –æ—Ç–≤–µ—Ç–∞**: <5KB ‚úÖ
- **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: Redis + –ª–æ–∫–∞–ª—å–Ω—ã–π ‚úÖ

## üîß –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### **–≠—Ç–∞–ø 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (1-2 —á–∞—Å–∞)**
1. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å API —Ä–æ—É—Ç—ã –≤ server.js
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
3. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å Redis TLS –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

### **–≠—Ç–∞–ø 2: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (2-3 —á–∞—Å–∞)**
1. ‚úÖ –°–æ–∑–¥–∞—Ç—å –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞
2. ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã —Å –ø—Ä–æ–µ–∫—Ü–∏–µ–π
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø–∞–≥–∏–Ω–∞—Ü–∏—é

### **–≠—Ç–∞–ø 3: –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ (2-3 —á–∞—Å–∞)**
1. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Redis –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
3. ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—é –∫–µ—à–∞

### **–≠—Ç–∞–ø 4: Frontend –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (2-3 —á–∞—Å–∞)**
1. ‚úÖ –£–º–µ–Ω—å—à–∏—Ç—å —á–∞—Å—Ç–æ—Ç—É –∑–∞–ø—Ä–æ—Å–æ–≤
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ª–µ–Ω–∏–≤—É—é –∑–∞–≥—Ä—É–∑–∫—É
3. ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å batch –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### **–≠—Ç–∞–ø 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (1-2 —á–∞—Å–∞)**
1. ‚úÖ Load testing —Å 2000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
2. ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
3. ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## üéØ –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### **–ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
- **–í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏**: 2-5 —Å–µ–∫ ‚Üí <500ms (90% —É–ª—É—á—à–µ–Ω–∏–µ)
- **–ß–∞—Å—Ç–æ—Ç–∞ –∑–∞–ø—Ä–æ—Å–æ–≤**: 30 —Å–µ–∫ ‚Üí 120 —Å–µ–∫ (75% —Å–Ω–∏–∂–µ–Ω–∏–µ)
- **–ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å**: 5 ‚Üí 2000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (400x)
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ 50%
- **–í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞**: <100ms –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## ‚ö†Ô∏è –ü–†–ò–û–†–ò–¢–ï–¢–´

### **–ö–†–ò–¢–ò–ß–ù–û (—Å–µ–π—á–∞—Å):**
1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å API —Ä–æ—É—Ç—ã
2. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
3. –ò—Å–ø—Ä–∞–≤–∏—Ç—å Redis

### **–í–ê–ñ–ù–û (—Å–ª–µ–¥—É—é—â–∏–µ 2-3 —á–∞—Å–∞):**
1. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å MongoDB –∑–∞–ø—Ä–æ—Å—ã
2. –î–æ–±–∞–≤–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
3. –£–º–µ–Ω—å—à–∏—Ç—å —á–∞—Å—Ç–æ—Ç—É –∑–∞–ø—Ä–æ—Å–æ–≤

### **–ñ–ï–õ–ê–¢–ï–õ–¨–ù–û (–≤ —Ç–µ—á–µ–Ω–∏–µ –¥–Ω—è):**
1. –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
2. Batch –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
3. Load testing

---

**üéØ –¶–ï–õ–¨: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 2000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –≤—Ä–µ–º–µ–Ω–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ <500ms** 